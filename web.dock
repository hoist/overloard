FROM node:0.10

RUN mkdir -p /usr/src/app

WORKDIR /usr/src/app

ENV NODE_MONGOOSE_MIGRATIONS_CONFIG=./config/migrations.js

ADD package.json /usr/src/app/package.json

RUN npm config set loglevel warn
RUN npm install mongoose-migrate -g
RUN npm install -g npm
RUN npm install --production
RUN npm install -g npm

ADD . /usr/src/app

CMD [ "./scripts/start_web.sh"]

EXPOSE 8000
